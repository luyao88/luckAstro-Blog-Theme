---
const { title, keywords, description, pagecover, activeNav, Home } = Astro.props

// ... å…¶ä»–å¯¼å…¥å’Œé…ç½® ...
const currentPath = Astro.url.pathname
const isHomePath =
  currentPath === '/' ||
  currentPath === '/index.html' ||
  currentPath.startsWith('/page/')

// ç½‘ç«™é…ç½®
import SITE_INFO from '@/config'
const { GoogleAds, Theme, HomeBanner } = SITE_INFO
const { ad_Client, asideAD_Slot, articleAD_Slot } = GoogleAds
// Head ä¾èµ–
import Head from '@/components/Head/Head.astro'
// é¡¶éƒ¨ Header
import Header from '@/components/Header/Header.astro'
// Main åŒºåŸŸ Header
import MainHeader from '@/components/MainHeader/MainHeader.astro'
// Asideç»„ä»¶
import Aside from '@/components/Aside/Aside.astro'
// åº•éƒ¨ Footer
import Footer from '@/components/Footer/Footer.astro'
// è¿”å›é¡¶éƒ¨åŠå…¶ä»–æŒ‰é’®
import BackTop from '@/components/BackTop/BackTop.astro'
// æ‰‹æœºç«¯ä¾§è¾¹æ 
import MobileSidebar from '@/components/MobileSidebar/MobileSidebar.astro'
// A Modern CSS Reset
import '@/styles/Reset.less'
// å…¨å±€åŸºç¡€æ ·å¼
import '@/styles/Base.less'
// Layout æ ·å¼
import './Layout.less'
---

<html lang="zh-CN">
  <Head
    Title={title}
    Keywords={keywords}
    Description={description}
    PageCover={pagecover}
  >
    <!-- è°·æ­Œå¹¿å‘ŠJSåŠ è½½é¡¹ -->
    {
      ad_Client && (asideAD_Slot || articleAD_Slot) && (
        <script
          is:inline
          async
          src={`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${ad_Client}`}
          crossorigin="anonymous"
        />
      )
    }
    <!-- å½©æ——ğŸˆ -->
    <script is:inline src="/assets/js/vhCaiqi.js" defer></script>
    <!-- è®¾ç½®ä¸»é¢˜é¢œè‰² -->

    <Fragment
      set:html={`<style>:root {
	  ${Object.entries(Theme)
      .map(([key, value]) => `${key}:${value};`)
      .join('')}
	  --vh-main-header-height:${Home ? HomeBanner.HomeHeight : HomeBanner.PageHeight};
	  --vh-home-banner:url('${HomeBanner.backgroundImg}');
	}</style>`}
    />
  </Head>
  <body>
    <MobileSidebar />
    <Header activeNav={activeNav} />
    <main class="main">
      {
        HomeBanner.enable && (
          <MainHeader isHome={isHomePath} activeNav={activeNav} />
        )
      }
      <section
        class="main-inner"
        style={`padding-top:${HomeBanner.enable ? '0.88rem' : 'calc(66px + 0.68rem)'}`}
      >
        <section class="main-inner-content">
          <slot />
        </section>
        <Aside />
      </section>
      <BackTop />
    </main>
    <Footer />
    <script type="text/javascript" src="/script/simplifiedConversion.js"
    ></script>
    <script>
      import InitFn from '@/scripts/Init'
      // æ·»åŠ é¡µé¢ç±»å‹æ£€æµ‹
      document.addEventListener('DOMContentLoaded', () => {
        // å…¨å±€åˆå§‹åŒ–
        InitFn()
        const path = window.location.pathname
        const isHome =
          path === '/' || path === '/index.html' || path.startsWith('/page/')
        ;(document.querySelector('main-header') as any)?.updateBackground(
          isHome
        )
      })
    </script>
  </body>
</html>
